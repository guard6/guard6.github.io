<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌟 CP 소통방 궁극의 홍보 게시판</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

    <style>
        /* [다음 섹션의 CSS 코드를 여기에 붙여넣으세요] */
    </style>
</head>
<body>
    <header>
        <h1 class="title">CP 소통방 궁극의 홍보 게시판 🚀</h1>
        <p class="subtitle">실시간 검색, 정렬 기능이 탑재된 고급 홍보물 목록입니다.</p>
    </header>

    <div class="main-content">
        <div class="registration-banner">
            <h2>📢 내 홍보물을 등록하고 싶다면?</h2>
            <p>아래 버튼을 눌러 소통방에 접속한 후, 챗봇에게 **!테스트 [내용]**을 입력하면 바로 등록됩니다!</p>
            <a href="여기에_홍보물_등록용_카카오톡_오픈채팅_링크를_넣으세요" target="_blank">
                ✅ 홍보물 등록방 바로가기
            </a>
        </div>
        
        <div class="controls-container">
            <input type="text" id="search-input" placeholder="제목이나 내용으로 검색..." class="search-box">
            <select id="sort-select" class="sort-dropdown">
                <option value="time_desc">최신순 (기본)</option>
                <option value="time_asc">오래된순</option>
                <option value="name_asc">작성자순</option>
            </select>
        </div>

        <div id="loading" class="loading-spinner"></div>
        
        <div id="promo-list" class="promo-container">
            </div>

        <h2 class="section-title">🏆 금주의 추천 홍보물 (고정)</h2>
        <div class="promo-container manual-promos">
            
            <div class="promo-item">
                <h3>🚗 차량 판매중! (분노의 질주 등)</h3>
                <p>⭐️아반떼N 등 국산차량, VIP 세단, 약 80대의 데칼 차량 판매. (5,000₩~20,000₩)</p>
                <p class="warning">주의: 카팍머니, 차교는 받지 않습니다.</p>
                <a href="https://open.kakao.com/me/ONCOMPANY" target="_blank">𝑶𝑱컴퍼니 전시샵 바로가기</a>
            </div>
            
            <div class="promo-item">
                <h3>🔥 카마로 로고작 출시!</h3>
                <p>새로운 카마로 로고 디자인을 확인하세요. 자세한 내용은 오픈 채팅방에서 안내해 드립니다.</p>
                <a href="https://open.kakao.com/o/spy1vNAh" target="_blank">문의/상담 오픈 채팅방 바로가기</a>
            </div>
            
        </div>
        
    </div>

    </body>
</html>
/* --- 기본 설정 및 폰트 --- */
:root {
    --bg-dark: #2C2F33;
    --bg-card: #2F3136;
    --bg-container: #36393F;
    --color-primary: #7289DA;
    --color-success: #43B581;
    --color-text: #DCDDDE;
    --color-light-text: #B9BBBE;
}

body {
    font-family: 'Noto Sans KR', sans-serif;
    text-align: center;
    padding: 0;
    background-color: var(--bg-dark);
    color: var(--color-text);
    margin: 0;
}

header {
    background-color: #23272A; /* 헤더 배경을 더 어둡게 */
    padding: 30px 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
}

.title {
    font-size: 2.8em;
    color: #FFFFFF;
    font-weight: 700;
}

.subtitle {
    font-size: 1.1em;
    color: var(--color-light-text);
}

.main-content {
    max-width: 1240px;
    margin: 0 auto;
    padding: 0 20px;
}

.section-title {
    color: var(--color-primary);
    border-bottom: 2px solid #4F545C;
    padding-bottom: 10px;
    margin-top: 40px;
    margin-bottom: 20px;
    text-align: left;
    font-size: 1.6em;
}

/* --- 등록 유도 배너 --- */
.registration-banner {
    background-color: var(--color-primary);
    color: #FFFFFF;
    padding: 25px;
    border-radius: 8px;
    margin-bottom: 40px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.registration-banner h2 {
    font-size: 1.5em;
    margin: 0 0 10px 0;
    border-bottom: none;
}

.registration-banner p {
    margin-bottom: 20px;
}

.registration-banner a {
    display: inline-block;
    background-color: var(--color-success);
    padding: 10px 25px;
    border-radius: 4px;
    font-weight: bold;
    text-decoration: none;
    color: #FFFFFF;
    transition: background-color 0.3s;
}

.registration-banner a:hover {
    background-color: #37956B;
}


/* --- 검색 및 정렬 컨트롤 --- */
.controls-container {
    display: flex;
    justify-content: space-between;
    gap: 20px;
    margin-bottom: 30px;
}

.search-box, .sort-dropdown {
    padding: 10px 15px;
    border-radius: 6px;
    border: 1px solid #4F545C;
    background-color: var(--bg-card);
    color: var(--color-text);
    font-size: 1em;
    transition: border-color 0.3s;
}

.search-box:focus, .sort-dropdown:focus {
    border-color: var(--color-primary);
    outline: none;
}

.search-box {
    flex-grow: 1;
}

/* --- 홍보물 컨테이너 (Flex Grid) --- */
.promo-container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: flex-start;
}

/* --- 개별 홍보물 카드 스타일 --- */
.promo-item {
    /* PC: 3개씩 배치 */
    flex: 1 1 350px; 
    min-width: 350px; 
    max-width: calc(33.33% - 20px); 
    
    background-color: var(--bg-card); 
    padding: 20px;
    border-radius: 10px;
    border-left: 5px solid var(--color-success); 
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
    text-align: left;
    
    /* 카드 내에서 버튼을 하단에 붙이기 위한 설정 */
    display: flex;
    flex-direction: column;
}

.promo-item:hover {
    transform: translateY(-5px); /* 호버 시 약간 뜸 */
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    background-color: #393C41; 
}

.promo-item h3 {
    margin-top: 0;
    color: #FFFFFF;
    font-size: 1.4em;
    margin-bottom: 10px;
}

.promo-item .metadata {
    font-size: 0.8em;
    color: var(--color-light-text);
    margin-bottom: 10px;
}

.promo-item p {
    color: var(--color-light-text);
    font-size: 1em;
    margin-bottom: 15px;
    /* 내용이 길 경우 자동으로 스크롤바가 생기도록 할 수도 있습니다 (선택 사항) */
    /* max-height: 100px; overflow-y: auto; */
    flex-grow: 1; /* 내용이 버튼 위에 붙도록 공간을 채움 */
}

/* --- 링크 버튼 스타일 --- */
.promo-item a {
    display: block; 
    text-align: center;
    color: #FFFFFF;
    text-decoration: none;
    font-weight: bold;
    background-color: var(--color-primary); 
    padding: 10px 15px; 
    border-radius: 6px;
    transition: background-color 0.3s;
    margin-top: auto; /* 버튼이 항상 카드 하단에 붙도록 함 */
}

.promo-item a:hover {
    background-color: #677BC4; 
}

.warning { color: #F04747; font-weight: bold; margin-top: 5px; }


/* --- 로딩 스피너 --- */
.loading-spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid var(--color-primary);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 50px auto;
    display: block; /* 기본은 표시 */
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* 검색 결과 없음 메시지 */
.no-results {
    width: 100%;
    text-align: center;
    color: var(--color-light-text);
    padding: 50px;
    font-size: 1.2em;
}

/* --- 3. 모바일 최적화 (768px 이하) --- */
@media (max-width: 768px) {
    .main-content {
        padding: 0 10px;
    }
    
    .title {
        font-size: 2em;
    }
    
    .controls-container {
        flex-direction: column; /* 모바일에서 검색/정렬을 세로로 배치 */
        gap: 10px;
    }
    
    .search-box, .sort-dropdown {
        width: 100%;
        box-sizing: border-box; /* 패딩이 폭에 포함되도록 */
    }

    .promo-item {
        /* 모바일에서 1개씩 세로로 쌓이도록 100% 폭 설정 */
        flex: 1 1 100%; 
        min-width: 100%; 
        max-width: 100%; 
        padding: 15px;
    }
}
<script>
    // 🚨 1. 중요: 여기에 본인의 Firebase 설정 정보를 입력하세요! 🚨
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY", 
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "YOUR_PROJECT_ID",
    };
    
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    
    const promoListElement = document.getElementById('promo-list');
    const loadingSpinner = document.getElementById('loading');
    const searchInput = document.getElementById('search-input');
    const sortSelect = document.getElementById('sort-select');
    
    let allPromos = []; // 모든 홍보물 데이터를 저장할 배열
    
    // --- 2. 데이터 가져오기 (Firebase) ---
    function fetchPromos() {
        loadingSpinner.style.display = 'block'; // 로딩 스피너 표시
        promoListElement.innerHTML = '';
        
        // Firebase에서 모든 데이터를 가져옵니다.
        database.ref('promos').once('value', (snapshot) => {
            const data = [];
            snapshot.forEach((childSnapshot) => {
                const promo = childSnapshot.val();
                data.push(promo);
            });
            
            allPromos = data;
            
            // 데이터 로드 후 필터링 및 렌더링 시작
            filterAndRenderPromos(); 
            loadingSpinner.style.display = 'none'; // 로딩 스피너 숨기기
            
        }, (error) => {
            loadingSpinner.style.display = 'none';
            promoListElement.innerHTML = `<div class="no-results">🚨 데이터 로딩 오류: ${error.message}</div>`;
        });
    }

    // --- 3. 데이터 정렬 ---
    function sortPromos(promos) {
        const sortValue = sortSelect.value; // 현재 선택된 정렬 기준
        const [key, direction] = sortValue.split('_');

        promos.sort((a, b) => {
            let comparison = 0;
            
            if (key === 'time') {
                // 시간은 내림차순(desc: 최신순)이 기본
                comparison = a.time - b.time; 
            } else if (key === 'name') {
                // 이름은 오름차순(asc: ㄱㄴㄷ순)이 기본
                const nameA = a.name.toUpperCase();
                const nameB = b.name.toUpperCase();
                if (nameA > nameB) comparison = 1;
                else if (nameA < nameB) comparison = -1;
            }
            
            // direction이 desc(내림차순)이면 결과를 반전시킵니다.
            return direction === 'asc' ? comparison : comparison * -1;
        });
        return promos;
    }

    // --- 4. HTML 렌더링 (화면에 표시) ---
    function renderPromos(promosToRender) {
        promoListElement.innerHTML = '';
        
        if (promosToRender.length === 0) {
            promoListElement.innerHTML = `<div class="no-results">검색 결과가 없습니다.</div>`;
            return;
        }

        promosToRender.forEach((promo) => {
            const contentWithBreaks = (promo.content || '').replace(/\n/g, '<br>');
            const linkButton = promo.link 
                ? `<a href="${promo.link}" target="_blank">자세히 보기 / 문의하기</a>` 
                : '';
            
            // 시간 포맷팅 (더 깔끔하게)
            const date = new Date(promo.time);
            const formattedDate = date.toLocaleDateString('ko-KR', { 
                year: 'numeric', month: '2-digit', day: '2-digit', 
                hour: '2-digit', minute: '2-digit' 
            });

            const promoHtml = `
                <div class="promo-item">
                    <h3>${promo.title || '제목 없음'}</h3>
                    <div class="metadata">
                        <span>작성자: ${promo.name || '익명'}</span> | 
                        <span>등록일: ${formattedDate}</span>
                    </div>
                    <p>${contentWithBreaks}</p>
                    ${linkButton}
                </div>
            `;
            promoListElement.innerHTML += promoHtml;
        });
    }

    // --- 5. 필터링 및 렌더링 통합 함수 ---
    function filterAndRenderPromos() {
        let filteredPromos = [...allPromos]; // 전체 목록 복사
        const searchTerm = searchInput.value.toLowerCase().trim(); // 검색어

        // 1. 검색어 필터링
        if (searchTerm) {
            filteredPromos = filteredPromos.filter(promo => 
                (promo.title && promo.title.toLowerCase().includes(searchTerm)) ||
                (promo.content && promo.content.toLowerCase().includes(searchTerm)) ||
                (promo.name && promo.name.toLowerCase().includes(searchTerm))
            );
        }
        
        // 2. 정렬
        const sortedPromos = sortPromos(filteredPromos);
        
        // 3. 화면에 표시
        renderPromos(sortedPromos);
    }
    
    // --- 6. 이벤트 리스너 등록 ---
    searchInput.addEventListener('input', filterAndRenderPromos); // 검색어 입력 시
    sortSelect.addEventListener('change', filterAndRenderPromos); // 정렬 기준 변경 시

    // --- 7. 초기 실행 ---
    fetchPromos();
</script>
